"""
í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ - ë„ë©”ì¸ë³„ íŠ¹í™” í”„ë¡¬í”„íŠ¸
ì˜ë£Œ, ê¸°ì—…, ê¸°ìˆ , ì¼ë°˜ ë„ë©”ì¸ì— íŠ¹í™”ëœ ê°œì¸ì •ë³´ ìœ„í—˜ë„ ë¶„ì„ í”„ë¡¬í”„íŠ¸
"""

class PromptTemplates:
    """ë„ë©”ì¸ë³„ í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ê´€ë¦¬"""

    @staticmethod
    def get_medical_prompt() -> str:
        """ì˜ë£Œ ë„ë©”ì¸ íŠ¹í™” í”„ë¡¬í”„íŠ¸"""
        return """
ë‹¹ì‹ ì€ ì˜ë£Œ ë„ë©”ì¸ì˜ ê°œì¸ì •ë³´ ë³´í˜¸ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. 
ì£¼ì–´ì§„ í…ìŠ¤íŠ¸ì—ì„œ ê°œì¸ì •ë³´ ë…¸ì¶œ ìœ„í—˜ë„ë¥¼ ë¶„ì„í•´ì£¼ì„¸ìš”.

**ë¶„ì„ ê¸°ì¤€:**
1. í™˜ì ê°œì¸ì •ë³´ (ì´ë¦„, ë‚˜ì´, ì„±ë³„, ì—°ë½ì²˜, ì£¼ì†Œ, í™˜ìë²ˆí˜¸)
2. ì˜ë£Œ ì •ë³´ (ì§„ë‹¨ëª…, ì²˜ë°©ì•½, ìˆ˜ìˆ ë‚´ìš©, ê²€ì‚¬ê²°ê³¼, ë³‘ë ¥)
3. ì˜ë£Œì§„ ì •ë³´ (ì˜ì‚¬ëª…, ê°„í˜¸ì‚¬ëª…, ë‹´ë‹¹ì, ì˜ë£Œì§„ ì—°ë½ì²˜)
4. ì˜ë£Œê¸°ê´€ ì •ë³´ (ë³‘ì›ëª…, ê³¼ëª…, ë³‘ì‹¤ë²ˆí˜¸)
5. ì¡°í•© ìœ„í—˜ë„ (ê°œì¸ì •ë³´ + ì˜ë£Œì •ë³´ ê²°í•©ì‹œ ìœ„í—˜ ì¦ê°€)

**ìœ„í—˜ë„ ë¶„ë¥˜:**
- CRITICAL (90-100ì ): í™˜ì ì™„ì „ ì‹ë³„ ê°€ëŠ¥ + ë¯¼ê°í•œ ì˜ë£Œì •ë³´
- HIGH (70-89ì ): ê°œì¸ì •ë³´ + ì˜ë£Œì •ë³´ ì¡°í•©ìœ¼ë¡œ ê°œì¸ ì‹ë³„ ê°€ëŠ¥ì„± ë†’ìŒ
- MEDIUM (40-69ì ): ì˜ë£Œì§„ ì •ë³´ ë˜ëŠ” ì¼ë°˜ì ì¸ ì˜ë£Œì •ë³´
- LOW (20-39ì ): ë¹„íŠ¹ì • ì˜ë£Œì •ë³´ ë˜ëŠ” ì¼ë°˜ ê±´ê°• ì •ë³´
- NONE (0-19ì ): ê°œì¸ì •ë³´ ì—†ëŠ” ì¼ë°˜ ì˜ë£Œ ì§€ì‹

**íŠ¹ë³„ ê³ ë ¤ì‚¬í•­:**
- í™˜ìë²ˆí˜¸ë‚˜ ì°¨íŠ¸ë²ˆí˜¸ê°€ ìˆìœ¼ë©´ ìœ„í—˜ë„ ìƒìŠ¹
- ë‚˜ì´+ì„±ë³„+ì§ˆë³‘ ì¡°í•©ì‹œ ì‹ë³„ ê°€ëŠ¥ì„± ë†’ìŒ
- ì˜ë£Œì§„ ê°œì¸ì •ë³´ë„ ë³´í˜¸ ëŒ€ìƒ

í…ìŠ¤íŠ¸: "{text}"

ë‹¤ìŒ JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•´ì£¼ì„¸ìš”:
{{
    "risk_score": ìˆ«ì (0-100),
    "risk_level": "CRITICAL|HIGH|MEDIUM|LOW|NONE",
    "detected_entities": ["ê°ì§€ëœ ê°œì²´ë“¤"],
    "explanation": "ìœ„í—˜ë„ íŒë‹¨ ê·¼ê±° (êµ¬ì²´ì ìœ¼ë¡œ)",
    "domain": "medical",
    "recommendations": ["ë§ˆìŠ¤í‚¹ ê¶Œì¥ì‚¬í•­"]
}}
"""

    @staticmethod
    def get_business_prompt() -> str:
        """ê¸°ì—… ë„ë©”ì¸ íŠ¹í™” í”„ë¡¬í”„íŠ¸"""
        return """
ë‹¹ì‹ ì€ ê¸°ì—… ì •ë³´ë³´í˜¸ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
ì£¼ì–´ì§„ í…ìŠ¤íŠ¸ì—ì„œ ê¸°ì—… ê¸°ë°€ì •ë³´ ë° ê°œì¸ì •ë³´ ë…¸ì¶œ ìœ„í—˜ë„ë¥¼ ë¶„ì„í•´ì£¼ì„¸ìš”.

**ë¶„ì„ ê¸°ì¤€:**
1. ì§ì› ê°œì¸ì •ë³´ (ì´ë¦„, ì—°ë½ì²˜, ì´ë©”ì¼, ì£¼ì†Œ, ì‚¬ë²ˆ)
2. ê¸°ì—… ê¸°ë°€ì •ë³´ (í”„ë¡œì íŠ¸ëª…, ì˜ˆì‚°, ë§¤ì¶œ, ê³„ì•½ë‚´ìš©, ì „ëµ)
3. ê±°ë˜ì²˜ ì •ë³´ (íŒŒíŠ¸ë„ˆì‚¬ëª…, ê³„ì•½ì¡°ê±´, ê±°ë˜ê¸ˆì•¡)
4. ì¡°ì§ ì •ë³´ (ë¶€ì„œ, ì§ê¸‰, ë³´ê³ ë¼ì¸)
5. ì¡°í•© ìœ„í—˜ë„ (ê¸°ì—…ì •ë³´ + ê°œì¸ì •ë³´ ê²°í•©ì‹œ ìœ„í—˜ ì¦ê°€)

**ìœ„í—˜ë„ ë¶„ë¥˜:**
- CRITICAL (90-100ì ): ê¸°ì—… í•µì‹¬ ê¸°ë°€ + ê°œì¸ì •ë³´ ì¡°í•©
- HIGH (70-89ì ): ì¤‘ìš” ê¸°ì—…ì •ë³´ ë˜ëŠ” ì§ì› ê°œì¸ì •ë³´
- MEDIUM (40-69ì ): ì¼ë°˜ ê¸°ì—…ì •ë³´ ë˜ëŠ” ì¡°ì§ ì •ë³´
- LOW (20-39ì ): ê³µê°œ ê°€ëŠ¥í•œ ê¸°ì—… ì •ë³´
- NONE (0-19ì ): ìœ„í—˜ ìš”ì†Œ ì—†ìŒ

í…ìŠ¤íŠ¸: "{text}"

JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•´ì£¼ì„¸ìš”:
{{
    "risk_score": ìˆ«ì (0-100),
    "risk_level": "CRITICAL|HIGH|MEDIUM|LOW|NONE",
    "detected_entities": ["ê°ì§€ëœ ê°œì²´ë“¤"],
    "explanation": "ìœ„í—˜ë„ íŒë‹¨ ê·¼ê±°",
    "domain": "business",
    "recommendations": ["ë³´ì•ˆ ê¶Œì¥ì‚¬í•­"]
}}
"""

    @staticmethod
    def get_technical_prompt() -> str:
        """ê¸°ìˆ  ë„ë©”ì¸ íŠ¹í™” í”„ë¡¬í”„íŠ¸"""
        return """
ë‹¹ì‹ ì€ ê¸°ìˆ  ë³´ì•ˆ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
ì£¼ì–´ì§„ í…ìŠ¤íŠ¸ì—ì„œ ê¸°ìˆ ì  ë¯¼ê°ì •ë³´ ë° ê°œì¸ì •ë³´ ë…¸ì¶œ ìœ„í—˜ë„ë¥¼ ë¶„ì„í•´ì£¼ì„¸ìš”.

**ë¶„ì„ ê¸°ì¤€:**
1. ê°œì¸ì •ë³´ (ê°œë°œìëª…, ì—°ë½ì²˜, ê³„ì •ì •ë³´, ì´ë©”ì¼)
2. ì¸ì¦ì •ë³´ (API í‚¤, í† í°, íŒ¨ìŠ¤ì›Œë“œ, ì¸ì¦ì„œ)
3. ì‹œìŠ¤í…œ ì •ë³´ (ì„œë²„ IP, ë°ì´í„°ë² ì´ìŠ¤ ì •ë³´, í¬íŠ¸, ê²½ë¡œ)
4. ì½”ë“œ ì •ë³´ (í•¨ìˆ˜ëª…, ë³€ìˆ˜ëª…, ì„¤ì •íŒŒì¼ ë‚´ìš©)
5. ì¡°í•© ìœ„í—˜ë„ (ì‹œìŠ¤í…œì •ë³´ + ì¸ì¦ì •ë³´ ê²°í•©ì‹œ ìœ„í—˜ ì¦ê°€)

**ìœ„í—˜ë„ ë¶„ë¥˜:**
- CRITICAL (90-100ì ): ì‹¤ì œ ì¸ì¦ í‚¤ + ì‹œìŠ¤í…œ ì ‘ê·¼ ì •ë³´
- HIGH (70-89ì ): API í‚¤, DB ì •ë³´, ê°œì¸ ì¸ì¦ ì •ë³´
- MEDIUM (40-69ì ): ì‹œìŠ¤í…œ êµ¬ì„± ì •ë³´ ë˜ëŠ” ì¼ë°˜ ê¸°ìˆ  ì •ë³´
- LOW (20-39ì ): ê³µê°œ ê¸°ìˆ  ì •ë³´ ë˜ëŠ” ì¼ë°˜ì ì¸ ì½”ë“œ
- NONE (0-19ì ): ìœ„í—˜ ìš”ì†Œ ì—†ìŒ

í…ìŠ¤íŠ¸: "{text}"

JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•´ì£¼ì„¸ìš”:
{{
    "risk_score": ìˆ«ì (0-100),
    "risk_level": "CRITICAL|HIGH|MEDIUM|LOW|NONE",
    "detected_entities": ["ê°ì§€ëœ ê°œì²´ë“¤"],
    "explanation": "ìœ„í—˜ë„ íŒë‹¨ ê·¼ê±°",
    "domain": "technical",
    "recommendations": ["ë³´ì•ˆ ê¶Œì¥ì‚¬í•­"]
}}
"""

    @staticmethod
    def get_general_prompt() -> str:
        """ì¼ë°˜ ë„ë©”ì¸ í”„ë¡¬í”„íŠ¸"""
        return """
ë‹¹ì‹ ì€ ê°œì¸ì •ë³´ ë³´í˜¸ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
ì£¼ì–´ì§„ í…ìŠ¤íŠ¸ì—ì„œ ê°œì¸ì •ë³´ ë…¸ì¶œ ìœ„í—˜ë„ë¥¼ ë¶„ì„í•´ì£¼ì„¸ìš”.

**ë¶„ì„ ê¸°ì¤€:**
1. ì§ì ‘ ê°œì¸ì •ë³´ (ì´ë¦„, ì—°ë½ì²˜, ì£¼ì†Œ, ì£¼ë¯¼ë²ˆí˜¸, ì´ë©”ì¼)
2. ê°„ì ‘ ê°œì¸ì •ë³´ (ë‚˜ì´, ì„±ë³„, ì§€ì—­, ì§ì—…, í•™ë ¥)
3. ë¯¼ê°ì •ë³´ (ê±´ê°•ìƒíƒœ, ì •ì¹˜ì  ì„±í–¥, ì¢…êµ, ì„±ì  ì§€í–¥)
4. ì¡°í•© ìœ„í—˜ë„ (ì—¬ëŸ¬ ì •ë³´ ê²°í•©ì‹œ ê°œì¸ ì‹ë³„ ê°€ëŠ¥ì„±)

**ìœ„í—˜ë„ ë¶„ë¥˜:**
- CRITICAL (90-100ì ): ì™„ì „í•œ ê°œì¸ ì‹ë³„ ê°€ëŠ¥ + ë¯¼ê°ì •ë³´
- HIGH (70-89ì ): ì§ì ‘ ê°œì¸ì •ë³´ ë˜ëŠ” ê°œì¸ ì‹ë³„ ê°€ëŠ¥
- MEDIUM (40-69ì ): ê°„ì ‘ ê°œì¸ì •ë³´ ì¡°í•©
- LOW (20-39ì ): ë¹„íŠ¹ì • ê°œì¸ì •ë³´
- NONE (0-19ì ): ê°œì¸ì •ë³´ ì—†ìŒ

í…ìŠ¤íŠ¸: "{text}"

JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•´ì£¼ì„¸ìš”:
{{
    "risk_score": ìˆ«ì (0-100),
    "risk_level": "CRITICAL|HIGH|MEDIUM|LOW|NONE",
    "detected_entities": ["ê°ì§€ëœ ê°œì²´ë“¤"],
    "explanation": "ìœ„í—˜ë„ íŒë‹¨ ê·¼ê±°",
    "domain": "general",
    "recommendations": ["ê°œì¸ì •ë³´ ë³´í˜¸ ê¶Œì¥ì‚¬í•­"]
}}
"""

    @staticmethod
    def get_all_prompts() -> dict:
        """ëª¨ë“  í”„ë¡¬í”„íŠ¸ ë°˜í™˜"""
        return {
            'medical': PromptTemplates.get_medical_prompt(),
            'business': PromptTemplates.get_business_prompt(),
            'technical': PromptTemplates.get_technical_prompt(),
            'general': PromptTemplates.get_general_prompt()
        }

    @staticmethod
    def detect_domain(text: str) -> str:
        """í…ìŠ¤íŠ¸ì—ì„œ ë„ë©”ì¸ ìë™ ê°ì§€"""
        text_lower = text.lower()

        # ì˜ë£Œ ë„ë©”ì¸ í‚¤ì›Œë“œ
        medical_keywords = [
            'í™˜ì', 'ì˜ì‚¬', 'ê°„í˜¸ì‚¬', 'ë³‘ì›', 'ì§„ë£Œ', 'ìˆ˜ìˆ ', 'ì²˜ë°©', 'ì•½ë¬¼', 'ì¹˜ë£Œ',
            'ì§„ë‹¨', 'ê²€ì‚¬', 'í˜ˆì••', 'í˜ˆë‹¹', 'ì˜ë£Œì§„', 'ì…ì›', 'ì™¸ë˜', 'ì‘ê¸‰ì‹¤',
            'ë³‘ë ¥', 'ì°¨íŠ¸', 'ì˜ë¬´ê¸°ë¡', 'ì²˜ë°©ì „', 'íˆ¬ì•½', 'ìˆ˜ìˆ ì‹¤', 'ë³‘ë™'
        ]

        # ê¸°ì—… ë„ë©”ì¸ í‚¤ì›Œë“œ
        business_keywords = [
            'í”„ë¡œì íŠ¸', 'ì˜ˆì‚°', 'ê³„ì•½', 'ê±°ë˜ì²˜', 'ë§¤ì¶œ', 'ì§ì›', 'ë¶€ì„œ', 'íšŒì‚¬',
            'ì‚¬ì—…', 'íˆ¬ì', 'ìˆ˜ìµ', 'ë¹„ìš©', 'ë§ˆì¼€íŒ…', 'ì˜ì—…', 'ê³ ê°', 'í´ë¼ì´ì–¸íŠ¸',
            'ì‚¬ì—…ë¶€', 'ë³¸ë¶€', 'ì§€ì‚¬', 'í˜‘ë ¥ì‚¬', 'íŒŒíŠ¸ë„ˆ', 'ê³„ì•½ì„œ', 'ì œì•ˆì„œ'
        ]

        # ê¸°ìˆ  ë„ë©”ì¸ í‚¤ì›Œë“œ
        technical_keywords = [
            'api', 'database', 'server', 'token', 'key', 'password', 'config',
            'ê°œë°œ', 'ì‹œìŠ¤í…œ', 'ì½”ë“œ', 'í”„ë¡œê·¸ë¨', 'ë°ì´í„°ë² ì´ìŠ¤', 'ì„œë²„', 'ë„¤íŠ¸ì›Œí¬',
            'url', 'endpoint', 'json', 'xml', 'sql', 'python', 'java', 'javascript',
            'ë°°í¬', 'ìš´ì˜', 'ëª¨ë‹ˆí„°ë§', 'ë¡œê·¸', 'ì¸ì¦', 'ë³´ì•ˆ', 'ì•”í˜¸í™”'
        ]

        # í‚¤ì›Œë“œ ë§¤ì¹­ìœ¼ë¡œ ë„ë©”ì¸ íŒë³„
        medical_score = sum(1 for keyword in medical_keywords if keyword in text_lower)
        business_score = sum(1 for keyword in business_keywords if keyword in text_lower)
        technical_score = sum(1 for keyword in technical_keywords if keyword in text_lower)

        scores = {
            'medical': medical_score,
            'business': business_score,
            'technical': technical_score
        }

        # ê°€ì¥ ë†’ì€ ì ìˆ˜ì˜ ë„ë©”ì¸ ì„ íƒ
        max_score = max(scores.values())
        if max_score == 0:
            return 'general'

        return max(scores, key=scores.get)

if __name__ == "__main__":
    # í”„ë¡¬í”„íŠ¸ í…ŒìŠ¤íŠ¸
    templates = PromptTemplates()

    test_texts = [
        "35ì„¸ ë‚¨ì„± í™˜ì ê¹€ì² ìˆ˜ê°€ ë‹¹ë‡¨ ì§„ë‹¨ë°›ì•˜ìŠµë‹ˆë‹¤.",
        "Phoenix í”„ë¡œì íŠ¸ ì˜ˆì‚° 50ì–µì›",
        "API í‚¤ sk-abc123 ì„¤ì •",
        "ì˜¤ëŠ˜ ë‚ ì”¨ê°€ ì¢‹ìŠµë‹ˆë‹¤."
    ]

    print("ğŸ” ë„ë©”ì¸ ìë™ ê°ì§€ í…ŒìŠ¤íŠ¸")
    print("=" * 50)

    for text in test_texts:
        domain = templates.detect_domain(text)
        print(f"í…ìŠ¤íŠ¸: {text}")
        print(f"ê°ì§€ëœ ë„ë©”ì¸: {domain}")
        print()